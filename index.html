<!DOCTYPE html>
<html>
<title>3 Generations of pop</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="multiline.css">
<link rel="stylesheet" type="text/css" href="style.css">	
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="multiline.js" charset="utf-8"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
<script src="script.js"></script>
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
body, html {
    height: 100%;
    color: #777;
    line-height: 1.8;
}
/* Create a Parallax Effect */
.bgimg-1, .bgimg-2, .bgimg-3 {
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
}
/* First image (home) */
.bgimg-1 {
    background-image: url('http://s3.amazonaws.com/production.mediajoint.prx.org/public/series_images/15048/frank-siniatra_medium.jpg');
    min-height: 100%;
}
/* Second image (valence) */
.bgimg-2 {
    background-image: url('https://upload.wikimedia.org/wikipedia/commons/e/ee/Kanye_West_Barclays_Center.png');
    min-height: 400px;
}
/* Third image (Contact) */
.bgimg-3 {
    background-image: url("https://upload.wikimedia.org/wikipedia/commons/d/d4/Michael_jackson_1992.jpg");
    min-height: 400px;
}
.w3-wide {letter-spacing: 10px;}
.w3-hover-opacity {cursor: pointer;}
/* Turn off parallax scrolling for tablets and phones */
@media only screen and (max-device-width: 1024px) {
    .bgimg-1, .bgimg-2, .bgimg-3 {
        background-attachment: scroll;
    }
}
</style>
<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar" id="myNavbar">
    <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);" onclick="toggleFunction()" title="Toggle Navigation Menu">
      <i class="fa fa-bars"></i>
    </a>
    <a href="#home" class="w3-bar-item w3-button">HOME</a>
    <a href="#project" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> THE PROJECT</a>
    <a href="#valence" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-th"></i> VALENCE</a>
    <a href="#energy" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-envelope"></i> ENERGY & DANCE</a>
    <a href="#topartists" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-envelope"></i> TOP ARTISTS</a>
    <a href="#" class="w3-bar-item w3-button w3-hide-small w3-right w3-hover-red">
      <i class="fa fa-search"></i>
    </a>
  </div>

  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium">
    <a href="#about" class="w3-bar-item w3-button" onclick="toggleFunction()">THE PROJECT</a>
    <a href="#valence" class="w3-bar-item w3-button" onclick="toggleFunction()">VALENCE</a>
    <a href="#contact" class="w3-bar-item w3-button" onclick="toggleFunction()">ENERGY & DANCE</a>
	<a href="#topartists" class="w3-bar-item w3-button" onclick="toggleFunction()">TOP ARTISTS</a>
    <a href="#" class="w3-bar-item w3-button">SEARCH</a>
  </div>
</div>

<!-- First Parallax Image with Logo Text -->
<div class="bgimg-1 w3-display-container w3-opacity-min" id="home">
  <div class="w3-display-middle" style="white-space:nowrap;">
    <span class="w3-center w3-padding-large w3-black w3-xlarge w3-wide w3-animate-opacity">4 GENERATIONS OF dfdf</span>
  </div>
</div>

<!-- Container (About Section) -->
<div class="w3-content w3-container w3-padding-64" id="project">
  <h3 class="w3-center">THE PROJECT</h3>
  <p class="w3-center"><em>An attempt to tell the history of our times through music and data</em></p>
  <div class="chart-wrapper" id="zeitgeistchart"><script type="text/javascript">
    d3.csv('zeitgeist2.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.artist = +d.artist;
        d.track = +d.track;
	d.position = +d.position;
	d.danceability = +d.danceability;
        d.energy = +d.energy;
	d.valence = +d.valence;    
    });
    var chart = makeLineChart(data, 'year', {
        'Average danceability': {column: 'danceability'},
        'Average energy': {column: 'energy'},
	'Average valence': {column: 'valence'},	  
    }, {xAxis: 'Years', yAxis: 'Metric'});
    chart.bind("#zeitgeistchart");
    chart.render();
});
  </script></div>
  
  <p>Music is arguably the strongest mark of an era. Think of the 1980s, what was the first thing that came to mind? To most of us, is the reverb of the snare, the artificial pitch of the synth, maybe When Doves Cry guitar solo – the music, always the music. </p>
  <p>Because of that, to analyse what people were listening to over the decades is a way to tell the history society itself. One of the ways to do so is by analysing how it evolved one year after another using data. That’s where Spotify comes in. </p>
  <p>The company holds metrics for all the songs it hosts. These metrics include numerical values to assess how danceable, how energetic and how positive they are; their duration and tempo; their key and mode; and, also, whether they’re instrumental, acoustic, or live. These metrics are available for anyone to use at Spotify’s API. </p>
  <p>For this project, I selected over 6,600 songs that made the Billboard Top 100 chart from 1941 to 2016, and, based on Spotify’s metric, I tried to measure how their qualities changed over these 76 years. </p>

  <div class="w3-row">
    <div class="w3-col m6 w3-center w3-padding-large">
      <p><b><i class="fa fa-user w3-margin-right"></i>The Zeitgeist Playlist</b></p><br>
      <iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A73hRb5b1aBauui3gGtYiFe" width="300" height="380" frameborder="0" allowtransparency="true"></iframe>
    </div>

    <!-- Hide this text on small devices NO NO NO MARK IMPORTANT MARK REMEMBER THE MARK -->
    <div class="w3-col m6 w3-padding-large">
      <h3>The Zeitgeist Playlist</h3>
	<p>One of the ideas was to see the average score for each year in three of the main metrics (danceability, energy and valence) and find which song would be more similar to that ideal type – which I called the zeitgeist songs. </p>
	<p>To get to that result, I subtracted the metrics of each song to the average metrics for the corresponding year. Then, I summed the three scores to reach a zeitgeist index – of course, I did multiply the negative scores by -1, so that one result would not nullify the other. </p>
	<p>Some of the results were surprisingly meaningful for an automated playlist. For example: the most shocking change in mood comes from 1966 to 1967 – possibly, the most revolutionary year in music history. Dandy, from the harmless, almost childish Herman’s Hermits is followed by Somebody To Love, Jefferson Airplane’s strange, aggressive, drug fuelled, fast paced rock anthem. </p>
    </div>
	<!-- BACK TO THE BEGINNING -->
	<h3>Metrics</h3>
<p>But, an important question: what are these metrics, anyway? And how does Spotify get these numbers? </p>
<p>There are eleven metrics provided by Spotify, but I selected three as the most significant for this exercise: danceability, which is a good way to assess the quality of the rhythm of a track, energy, which measures pace, loudness and noisiness, and valence, which is the overall mood of the song. A more complete explanation of the metrics can be found here. </p>
<p>Spotify gets these numbers using signal processing techniques. In 2014, they acquired Echo Nest, a company that specialized in these sort of services, to improve playlists and recommendations on their own services. </p>
<div class="w3-row">
    <div class="w3-col m6 w3-center w3-padding-large">
      <p><b><i class="fa fa-user w3-margin-right"></i>The Top 1 playlist</b></p><br>
      <iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A0mj2zFE6cuNV3KsN2qHaNi" width="300" height="380" frameborder="0" allowtransparency="true"></iframe>
    </div>

    <!-- Hide this text on small devices NO NO NO MARK IMPORTANT MARK REMEMBER THE MARK -->
    <div class="w3-col m6 w3-padding-large">
      <h3>The Greatest Hits</h3>
<p>Another way to experiment the way music evolved is by going through the greatest hits of each year. This playlist has all the number 1 hits since 1941 – except for 1978’s Shadow Dance, by Andy Gibbs, not available on Spotify, and Candle In The Wind 1997, by Elton John – only the 1974 version is available at the service. </p>
<p>I replaced both songs with their respective runner-ups: Fever Nights, by Bee Gees, and Foolish Games, by Jewel. </p>
   <h3>Gender issues</h3>
<p>Working with these two smaller datasets, it was possible to make some qualitative analysis beyond the raw data from Spotify. </p>
<p>One particular thing that caught my attention is the evolution of women in music. Before 1975, very few songs in these datasets were sung by woman – 15%. Since 1975, this number raised to 39%. Although this is just a sample of the entire data, it still shows how music tells the story of our society. </p> 
	</div></div>
  <div class="w3-center" id="women" style="width: 960px; height: 800px;"></div>
  <script>var data = [{
  values: [51,11,1,7],
  labels: ['Male singers', 'Female singers', 'Duets', 'Instrumental'],
  domain: {
    x: [0, .48]
  },
  name: 'Before 1975',
  hoverinfo: 'label+percent+name',
  hole: .4,
  type: 'pie'
},{
  values: [47,32,3,0],
  labels: ['Male singers', 'Female singers', 'Duets', 'Instrumental'],
  text: 'After 1975',
  textposition: 'inside',
  domain: {x: [.52, 1]},
  name: 'After 1975',
  hoverinfo: 'label+percent+name',
  hole: .4,
  type: 'pie'
}];
var layout = {
  title: 'Women & Charts - 1941-2016',
  annotations: [
    {
      font: {
        size: 14
      },
      showarrow: false,
      text: 'Before 1975',
      x: 0.17,
      y: 0.1
    },
    {
      font: {
        size: 14
      },
      showarrow: false,
      text: 'After 1975',
      x: 0.82,
      y: 0.1
    }
  ],
  height: 800,
  width: 960
};
	  
  Plotly.newPlot('women', data, layout);</script>	

<!-- Second Parallax Image with Portfolio Text -->
<div class="bgimg-2 w3-display-container w3-opacity-min">
  <div class="w3-display-middle" style="white-space:nowrap;">
    <span class="w3-xxlarge w3-text-white w3-wide">VALENCE</span>
  </div>
</div>

<!-- Starts the VALENCE section -->

<div class="w3-content w3-container w3-padding-64" id="valence">
  <h3 class="w3-center">VALENCE</h3>
  <p class="w3-center"><em>Valence is how Spotify measures the positivity of a song. The closer it is to 1, the more positive it is.</em></p>
  <div class="chart-wrapper" id="valencechart1"><script type="text/javascript">
    d3.csv('valenceyear.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.valenceaverage = +d.valenceaverage;
        d.minorkeys = +d.minorkeys;        
    });
    var chart = makeLineChart(data, 'year', {
        'Average valence of the songs': {column: 'valenceaverage'},
        'Percentage of songs in minor keys': {column: 'minorkeys'},
    }, {xAxis: 'Years', yAxis: 'Amount'});
    chart.bind("#valencechart1");
    chart.render();
});
  </script></div>
  
<p>Think of the 1990s. Heavy guitar riffs, heroin addicts wearing flannel shirts and singing about suicide. To say that this decade was the exact moment when our popular music started to get darker, sadder and angrier is not a surprise by any means. What is surprising, though, is that Celine Dion has more to do with it then Kurt Cobain. </p>
<p>In 1963, the average valence for a Billboard Top 100 song was 0.69. During the following 25 years, it oscillated between 0.63 and 0.67. Around the end of the 1980s, it started to drop dramatically. First, to around 0.55, in the mid-90s. After a slight and brief recovery in the early 2000s, it dropped again, until it fell below 0.50 in the mid-2010s. </p>
<p>But why did this happen? One first plausible is that super-euphoric songs have progressively become out of fashion. Between the 1960s and the 1980s, around a third of the songs had an average valence above 0.8. In 2016, only 4 songs were had such a high score. </p> 
<p>The number of very depressive songs (below 0.2), on the other hand, remained stable over the years. This means that modern pop music tend to be in the mid ranges. </p>
<div class="chart-wrapper" id="valencechart2"><script type="text/javascript">
    d3.csv('valencebyrange4.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.euphoric = +d.euphoric;
		d.happy = +d.happy;
		d.midrange = +d.midrange;
		d.sad = +d.sad;
		d.depressive = +d.depressive;        
    });
    var chart = makeLineChart(data, 'year', {
        'Above 0.8': {column: 'euphoric'},
        'Between 0.6 and 0.8': {column: 'happy'},
	'Between 0.4 and 0.6': {column: 'midrange'},
        'Between 0.2 and 0.4': {column: 'sad'},
	'Below 0.2': {column: 'depressive'},
    }, {xAxis: 'Decade', yAxis: '% of songs'});
    chart.bind("#valencechart2");
    chart.render();
});
  </script></div>
  
  <h3>Majors and minors</h3>
<p>What might also have contributed to this decrease in valence of the average hit is the fact minor scales have become more popular amongst composers. Back in the 1950s, between 10% and 20% of the popular songs were written in minor scales, whereas in 2016 43% of the hits were in such keys. </p>
<div class="w3-row">
    <div class="w3-col m6 w3-center w3-padding-large">
	<script type="text/javascript">
$(document).ready(function(){
    $("select").change(function(){
        $(this).find("option:selected").each(function(){
            var optionValue = $(this).attr("value");
            if(optionValue){
                $(".box").not("." + optionValue).hide();
                $("." + optionValue).show();
            } else{
                $(".box").hide();
            }
        });
    }).change();
});
</script>

      <p><b>Metric generated playlists</b></p><br>
      <div>
        <select>
            <option>What kind of music do you want to hear?</option>
            <option value="happy">Something that makes me happy!</option>
            <option value="average">What is the average song like?</option>
            <option value="middle">The exact middle point between light and darkness</option>
	    <option value="sad">The most negative ones in this dataset</option>	
        </select>
	    </div>
	    <div class="happy box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A4BCR5Of4sgKaOcvCFsRLT6" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
            <div class="average box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A63AgtDSxDwv7sLx7pnrGoI" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
            <div class="middle box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A1N4cm1Fr8wCKoLsOpGyyBw" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	    <div class="sad box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A5P8KJdRsgufFbQsKDUb4Cu" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	</div>
    
    <!-- Hide this text on small devices NO NO NO MARK IMPORTANT MARK REMEMBER THE MARK -->
    <div class="w3-col m6 w3-padding-large">
    <p>Usually, minor scales tend to be associated with melancholy, while major scales are usually more upbeat. That does not necessarily mean that every minor melody is depressing, or the other way around. Donna Summer’s She Work Hard for the Money, the most upbeat track in the entire dataset, happens to be in G# minor, and R. Kelly’s I Believe I Can Fly, one of the saddest, is in G major. But it usually makes sense. </p>
<p>To understand this effect, listen to Way To Blue, by Nick Drake. In this song, he alternates minor and major scales back and forth. The melody of the first two verses (“Don’t you have a word to show what may be done / Have you never heard a way to find the sun”) is minor; the follow-up (“Tell me all that you may know / Show me what you have to show”) is major. You can spot the difference in mood straight away. </p>
<p>Since mode might be one of the factors to assess the tracks’ valence ratings, an increase in the proportion minor melodies might reflect on the average valence – and, of course, on the mood of modern music itself. </p>
 </div>
<h3>Kurt and Celine</h3>
<p>It’s hard to pinpoint one specific reason for why euphoric tunes got out of style in the 1990s, or why modern composers tend to like minor scales more than before. What we can say for sure is that grunge has very little to do with it – at least with the metrics themselves. </p>
<p>The dataset was based on number of singles sold, and Smells Like Teen Spirit was the only Nirvana single that made it to the yearly Billboard Top 100 – and, surprisingly, it’s considered a relatively positive song, with a 0.68 valence score. The same goes for pretty much all the grunge artists. </p>
<p>On the other hand, seven Celine Dion singles from the 90s appear in this data set, and six of them had valence ratings lower than 0.3 – including, of course, My Heart Will Go On. </p>
</div>

<!-- Third Parallax Image with Portfolio Text -->
<div class="bgimg-3 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
     <span class="w3-xxlarge w3-text-white w3-wide">ENERGY & DANCE</span>
  </div>
</div>

<!-- ENERGY & DANCE SECTION -->

<div class="w3-content w3-container w3-padding-64" id="energy">
  <h3 class="w3-center">ENERGY & DANCE</h3>
  <p class="w3-center"><em>In 76 years, music has become more danceable and more energetic.</em></p>
  <div class="chart-wrapper" id="energychart"><script type="text/javascript">
    d3.csv('energy.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.energy = +d.energy;
        d.loudness = +d.loudness;        
    });
    var chart = makeLineChart(data, 'year', {
        'Average energy of the songs': {column: 'energy'},
        'Average loudness (adjusted to scale)': {column: 'loudness'},
    }, {xAxis: 'Years', yAxis: 'Average'});
    chart.bind("#energychart");
    chart.render();
});
  </script></div>
  
 <p>If there is one single musical feature that changed entirely from the 1940s to the 2000s is the energy. Try talking to your grandparents about music. They’ll probably think the music you listen to – whichever it is – is too loud, too aggressive, too noisy. And you’ll probably fall asleep after no more than 5 minutes listening to what your grandpa used to party to back in the day. </p>
<p>This is reflected on Spotify. The average score for energy of the greatest hits of the 1940s is below 0.3, whereas, since the mid-1970s, this score has been consistently above 0.6. Part of this evolution can be attributed to studio techniques, which allowed us to record and master louder sounds with much higher definition. </p>

<div class="w3-col m6 w3-center w3-padding-large">
	<script type="text/javascript">
$(document).ready(function(){
    $("select").change(function(){
        $(this).find("option:selected").each(function(){
            var optionValue = $(this).attr("value");
            if(optionValue){
                $(".box").not("." + optionValue).hide();
                $("." + optionValue).show();
            } else{
                $(".box").hide();
            }
        });
    }).change();
});
</script>

      <p><b>Metric generated playlists</b></p><br>
      <div>
        <select>
            <option>What kind of music do you want to hear?</option>
            <option value="energetic">Something very energetic</option>
            <option value="danceable">The best for dancing</option>
            <option value="energydance">Great energy and great danceability</option>
	    <option value="lowenergy">I need some sleep, low energy please</option>
	    <option value="lowdance">I'm the reverend from Footloose, stop the dancing</option>	
	    <option value="lowlowlow">No energy, no danceability</option>	 	
        </select>
	    </div>
	    <div class="energetic box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A5iNH4J376ALzx9gkcpxScF" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	    <div class="danceable box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A4tZk14LGb2a1EfjCBVGYKe" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	    <div class="energydance box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A2WhNeXPtVCUZsityThoOrh" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div> 
	    <div class="lowenergy box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A0yZjSJoKOePwSilJ8qkufe" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	    <div class="lowdance box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A0JDWspQYHErWNUyJSfgVKH" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
	    <div class="lowlowlow box"><iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3Achicomares%3Aplaylist%3A77x9VYtkVzNBqaYVIUegEr" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div> 
	
	</div>

<div class="w3-col m6 w3-padding-large"><p>While the growth in the average energy of music from the 1940s to the 1970s was pretty much steady, since then it has gone up and down periodically. The late 1980s and the 2000s decade were times of highly energetic music, whereas the average energy score declined by almost 10% during the 1990s. And, right now, our music is getting less energetic: it dropped from 0.75 in 2011 to 0.62 last year. </p>
<h3>The age of dance</h3>
<p>Although last year’s biggest hits were relatively not very energetic, they were certainly danceable. The danceability score for the 2016 were one of the highest of the historic series: 0.66. </p>
<p>The average danceability score has increased since the 1940s, but not in a dramatic fashion as energy. It rose steadily from a 0.48 average on the 1940s to a 0.64 average on the 1990s, and it has been around that mark for the last 20 years. </p>
	</div>
	
  <h3>Metrics</h3>
<p>But what do they mean by energy and danceability, since they’re very subjective concepts? Energy has to do with loudness, speed, aggressiveness. Heavy metal, for instance, usually scores very high for this – obviously not on this dataset, Raining Blood, by Slayer, scores almost 1 for energy and almost 0 for valence, a typical heavy metal setup. </p>
<p>It sometimes means that this metric is distorted by loud background noises – Svefn-g-englar, by Sigur Rós, has a 0.5 energy score, despite being a 10-minute-long lullaby (also, obviously not on this dataset). </p>
<p>Danceability is measured based on the track’s “tempo, rhythm stability, beat strength, and overall regularity”. </p>
<div class="chart-wrapper" id="dancechart"><script type="text/javascript">
    d3.csv('dance.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.danceability = +d.danceability;
               
    });
    var chart = makeLineChart(data, 'year', {
        'Average danceability': {column: 'danceability'}
        
    }, {xAxis: 'Years', yAxis: 'Average'});
    chart.bind("#dancechart");
    chart.render();
});
  </script></div>	
</div>

<!-- Third Parallax Image with Portfolio Text -->
<div class="bgimg-3 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
     <span class="w3-xxlarge w3-text-white w3-wide">ENERGY & DANCE</span>
  </div>
</div>

<!-- TOP ARTISTS SECTION -->

<div class="w3-content w3-container w3-padding-64" id="topartists">
  <h3 class="w3-center">TOP ARTISTS</h3>
  <p class="w3-center"><em>The greatest (and the not so great) hitmakers of history in one chart.</em></p>
 <svg></svg><div id="hitmakers">
  <script>
  d3.json("hitmakers.json", function(err, api) {
	
      var w = 960;
      var h = 500;
      var chart1 = d3.select("#hitmakers")
      .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
.append("g")
      
      //counting fuvar chart1 = d3.select("#hitmakers")nctions under each API section
      //this is not quite comprehensive because I arbitrarily removed some
      //functions that would add clutter, and didn't include sub functions
      var nested = d3.nest()
      .key(function(d) { return d.artist})
      .rollup(function(d) { return d.length })
      .map(api)
      
      var groups = Object.keys(nested);
      
      var color = d3.scale.category20c()
      .domain(groups);
      
      var prepArtists = groups.map(function(t) {
        return {
          artist: t,
          children: [{value: nested[t]}]
        }
      })


      var artistObj = {artist:"API", children:prepArtists};

      var treemap = d3.layout.treemap()
      .size([w,h])
      .sort(function(a,b) { return a.value - b.value })
      .value(function(d) { return d.value })
      var nodes = treemap.nodes(artistObj)

      var svg = d3.select("svg");
      var gs = svg.selectAll("g.cell")
      .data(nodes)
      .enter()
      .append("g").classed("cell",true);
      gs.append("rect")
      .attr({
        x: function(d) { return d.x },
        y: function(d) { return d.y },
        width: function(d) { return d.dx },
        height: function(d) { return d.dy}
      })
      .style({
        opacity: function(d) { return !!d.parent },
        fill: function(d) { if(d.parent) return color(d.parent.artist) }
      })

      svg.selectAll("text.cell")
      .data(nodes).enter()
      .append("text")
      .text(function(d) { if(d.parent && d.parent.artist != "API") return d.parent.artist })
      .attr({
        x: function(d) { return d.x + 10 },
        y: function(d) { return d.y - 10 },
        transform: function(d) {
          return "rotate(90," + [d.x, d.y]+")"
		
        }
	
      })
});

</script></div>
</div>
<!-- Container (Portfolio Section) -->
<div class="w3-content w3-container w3-padding-64" id="portfolio">
  <h3 class="w3-center">MY WORK</h3>
  <p class="w3-center"><em>Here are some of my latest lorem work ipsum tipsum.<br> Click on the images to make them bigger</em></p><br>

  <!-- Responsive Grid. Four columns on tablets, laptops and desktops. Will stack on mobile devices/small screens (100% width) -->
  <div class="w3-row-padding w3-center">
    <div class="w3-col m3">
      <img src="/w3images/p1.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="The mist over the mountains">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p2.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Coffee beans">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p3.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Bear closeup">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p4.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Quiet ocean">
    </div>
  </div>

  <div class="w3-row-padding w3-center w3-section">
    <div class="w3-col m3">
      <img src="/w3images/p5.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="The mist">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p6.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="My beloved typewriter">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p7.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Empty ghost train">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p8.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Sailing">
    </div>
    <button class="w3-button w3-padding-large" style="margin-top:64px">LOAD MORE</button>
  </div>
</div>

<!-- Modal for full size images on click-->
<div id="modal01" class="w3-modal w3-black" onclick="this.style.display='none'">
  <span class="w3-button w3-large w3-black w3-display-topright" title="Close Modal Image"><i class="fa fa-remove"></i></span>
  <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
    <img id="img01" class="w3-image">
    <p id="caption" class="w3-opacity w3-large"></p>
  </div>
</div>



<!-- Container (Contact Section) -->
<div class="w3-content w3-container w3-padding-64" id="contact">
  <h3 class="w3-center">WHERE I WORK</h3>
  <p class="w3-center"><em>I'd love your feedback!</em></p>

  <div class="w3-row w3-padding-32 w3-section">
    <div class="w3-col m4 w3-container">
      <!-- Add Google Maps -->
      <div id="googleMap" class="w3-round-large w3-greyscale" style="width:100%;height:400px;"></div>
    </div>
    <div class="w3-col m8 w3-panel">
      <div class="w3-large w3-margin-bottom">
        <i class="fa fa-map-marker fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Chicago, US<br>
        <i class="fa fa-phone fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Phone: +00 151515<br>
        <i class="fa fa-envelope fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Email: mail@mail.com<br>
      </div>
      <p>Swing by for a cup of <i class="fa fa-coffee"></i>, or leave me a note:</p>
      <form action="/action_page.php" target="_blank">
        <div class="w3-row-padding" style="margin:0 -16px 8px -16px">
          <div class="w3-half">
            <input class="w3-input w3-border" type="text" placeholder="Name" required name="Name">
          </div>
          <div class="w3-half">
            <input class="w3-input w3-border" type="text" placeholder="Email" required name="Email">
          </div>
        </div>
        <input class="w3-input w3-border" type="text" placeholder="Message" required name="Message">
        <button class="w3-button w3-black w3-right w3-section" type="submit">
          <i class="fa fa-paper-plane"></i> SEND MESSAGE
        </button>
      </form>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="w3-center w3-black w3-padding-64 w3-opacity w3-hover-opacity-off">
  <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>
  <div class="w3-xlarge w3-section">
    <i class="fa fa-facebook-official w3-hover-opacity"></i>
    <i class="fa fa-instagram w3-hover-opacity"></i>
    <i class="fa fa-snapchat w3-hover-opacity"></i>
    <i class="fa fa-pinterest-p w3-hover-opacity"></i>
    <i class="fa fa-twitter w3-hover-opacity"></i>
    <i class="fa fa-linkedin w3-hover-opacity"></i>
  </div>
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>
 
<!-- Add Google Maps -->
<script>
function myMap()
{
  myCenter=new google.maps.LatLng(41.878114, -87.629798);
  var mapOptions= {
    center:myCenter,
    zoom:12, scrollwheel: false, draggable: false,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };
  var map=new google.maps.Map(document.getElementById("googleMap"),mapOptions);
  var marker = new google.maps.Marker({
    position: myCenter,
  });
  marker.setMap(map);
}
// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}
// Change style of navbar on scroll
window.onscroll = function() {myFunction()};
function myFunction() {
    var navbar = document.getElementById("myNavbar");
    if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        navbar.className = "w3-bar" + " w3-card-2" + " w3-animate-top" + " w3-white";
    } else {
        navbar.className = navbar.className.replace(" w3-card-2 w3-animate-top w3-white", "");
    }
}
// Used to toggle the menu on small screens when clicking on the menu button
function toggleFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBu-916DdpKAjTmJNIgngS6HL_kDIKU0aU&callback=myMap"></script>
<!--
To use this code on your website, get a free API key from Google.
Read more at: https://www.w3schools.com/graphics/google_maps_basic.asp
-->

</body>
</html>
